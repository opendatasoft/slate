sudo: false
language: ruby
rvm:
  - 2.3.3
  - 2.4.0
cache: bundler
env:
  global:
  - DEPLOY_PATH=/var/www/apidoc/management
  - DEPLOY_BETA_PATH=/var/www/betaapidoc/management
  - secure: "AAcFoL3nq5GkHcNyNLIgUmkwQ4ONiWGqKXe0xlFj+2g6ZF54hCeYWs7oT/p7nScP+XR5WAbg1ksNGRuMUy0/lHH8pTeyv77EwaGiHZrQmH/ySjdKPEx0bvS3P8KL8w4y0MzzH/TDXFg+ppWXth0Rsm3n82EziCndomj/aD+vkE1EiJiXZvwDaZ3UxiskvXKC+JlTDkl+UcuCXz5CMD+MN60CT3un3ALz9zqxE5jHO7ibfcoSpgLJVk40LPczswbv4mVcxNfeack5yRHtRkJ8pGY96hwA7xI6jZEaohDReE1tlK2yI9xA2Pm6Jz+IevRNo0DDwSmtfCGBCFLsc78V+rVVQXzrJaP8LVZ/RwAAgqctk2Ih7W7OggPN1fpv0nFblorYrqcuA5ReqpaZamFuC8BA8HA8a6SbcG4BWMrB+fX3j0NMRL9J3TRPC4irgtIX6vQEXLiky68c5XZ2wCUZ9o4t3V7Ypi6tr5LpmKQfm6N6HU41gPNzI7+E9UJacePluEDEPwYlHG4VirO/iXaU9g2g4AlKcozmXJAaYZ8dLK4Vy9cGTIT/M8vuHL1E3G9HCxTPKdnxyc4JcavBqddu9cm6p0t+uy3rmvZnjYHLmZQsneQm7SNAbagfElvONDhR35UnBg0ilyQ6N7da7Kh3C9pDeE7MBmccEzM0sc78P5Y="
  - secure: "dyd7sKoIOYMfDRz6Xv3E4bVOVpxD3W8ABYEaOuIPLCsK8PrN4x4Wf8KfGlChVGYrJ9DGkBvlWJuXIF2v9u+DvLLXAJzqMBrP5HDY+3rNDMOTNSGr36bGP49WlsxABc48NmnsJJ7x/zhjFzulT9+Wifdluc0UebfgIe0YVmibKDU6rdfo0qRhYEhVpspUhJe7odW5tuRWXI6j51MkX/L70ho3u1hApisSeP0x6iKfWIeuG2yExfCg+oEEUBXtfdbFozMLktQVp9i8RMF/m6yDeIFpglGp5788aOrIbhRQ2pQ2+2vHq1V/XQX81+ztt4PNWJmFXevW7EWNmSkB50NAT+vaU8bduRF4mVTHUmUIjNi0XtvGYBFpyxknYwDqERD3k3CVu/TblO/zkJvDLoL4HiG5jbzdGXT6tUFhBLs7h8T78UmGuItTujo8+pV6v3+NAM6iS2xobhSEzpeWlU4MeXlQMHQVbKSORQ6J1P8z2ChTSmYwrp+9W4uSkjZAIql8HYtMGPxYbeNON0DEBXUx9JSe0lRR5GPFO+VJ78OdAqQoD6NijmYxQ8hFVaSd6xFbVMYt1o+vPacjplSMW5km2fRG2d0QHgdZwo5zkg/2Hyhw1hE45XNQuAb43pzkHh67W+MIquHvZtdV4iQzPwo7Mf1qIuK4PPhhSk+viOVGzSY="
install: bundle install
script: bundle exec middleman build
after_success:
  - openssl aes-256-cbc -K $encrypted_afc97d917c10_key -iv $encrypted_afc97d917c10_iv -in .travis.deploy.enc -out .travis.deploy -d
  - chmod 600 .travis.deploy
  - eval "$(ssh-agent -s)"
  - ssh-add .travis.deploy
  - test $TRAVIS_PULL_REQUEST == "false" && test $TRAVIS_BRANCH == "master" && rsync -e "ssh -o StrictHostKeyChecking=no" -az --force --delete build/ "$DEPLOY_USER"@"$DEPLOY_IP":"$DEPLOY_PATH" 2>/dev/null
  - test $TRAVIS_PULL_REQUEST == "false" && test $TRAVIS_BRANCH == "develop" && rsync -e "ssh -o StrictHostKeyChecking=no" -az --force --delete build/ "$DEPLOY_USER"@"$DEPLOY_IP":"$DEPLOY_BETA_PATH" 2>/dev/null
notifications:
  slack:
    secure: P/I0H5JW8Dw0ZprYm+ChcKg3D8Ma1Eatm1oXSCrOi9+iev85BnP2gibo3DJKazyvRiG2wbEhShNAe9cX5g0DfLn+LKpR4hSPs99d462PGYfo26d70eRvu1TiX3r3aOChY0x0JKh1qP5sqxbHyzVqIiMn1pnQ5NOauc1CDHMjNQ5gtVcxe7VUI7tGeyslJ4q6Pg3MeNEcWxLJlJZf37krTU6VDT2j4PsQd7z2pGodNW2P/x7LPcUCSBbmkmq2Bs8jIKJaaI5LIYN3hd/gXW6blHDGLeO8FY9nLF8vBgGkRXqn+VITVYLsgnoxKmypqN75mBgplBesVPATO4EN9h2EIMB22ugHyX5s1ybqsdDMhQPwNegBSq4ocjGnPW4BjQOtwD3U/NmuVd29LK0GmiJYPdsDlOI3zbuWb2AaaMiDdsDNGBJbiMCKhlER37E5lAr/v7SkajIse8uICkxvdXSnYxazQRHUhDHwaeDZS601SBwlLRrayrycD3s4Zc9EWVhftXB97H60qdrvBHDjrTzGNwKNQxRTj1Mxp1C2yv2cdlx7uoCrCtMuiq4kjxlZOaxAD0pL8DGsrKfgu0jslK2BRfA5wMk6BNxLuwcDIg6VJT7Q78s1SJ6NMZQJcAPHdH7m0eq5fQs8fOzAa5OveWnLudWR/KZTLJHEy21krWjT9B8=
